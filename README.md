# Piastra2D
Piastra2D is a simple code, which solves inviscid compressible hydrodynamic and magnetohydrodynamic (MHD) equations within a finite volume framework, using high order Godunov-type methods with TVD Runge-Kutta (RK) timestepping. It is written for teaching purposes in Python with an extensive usage of NumPy library.

By now, Piastra2D can solve 1D and 2D linear advection, compressible hydro and MHD equations on a structured uniform Cartesian grid. The solver utilizes a finite volume approach with approximate Riemann solver solution to obtain fluxes of conservative state variables on cell faces. Users can choose between Local Lax-Friedrichs ('LLF', Rusanov (1961)), Harten-Lax-van Leer ('HLL', Harten, Lax and van Leer (1983)) and HLL-Contact ('HLLC', Toro et al (1994)) flux functions for hydrodynamics, and between LLF or HLL flux for MHD. The advection equation can be solved, using Riemann solution with high-order RK timestepping or by using Lax-Wendroff scheme. To increase the order of approximation in space, the code uses piecewise-linear method with slope limiter ('PLM', second order of accuracy in space) or Weighted Essentially Non-Oscillating method WENO5 ('WENO', fifth order in space), as well as Piecewise Parabolic Method ('PPM', which correspond to PPM5 method from [A. Mignone, J Comp Phys, 270, 1, 784 (2014)], and original PPM version 'PPMorig', introduced in [P. Colella and P. R. Woodward, J Comp Phys 54  174–201 (1984)]). To achieve a better accuracy in time, the code utilizes Total Variation Diminishing multistage RK timestepping (methods 'RK2' and 'RK3' from [C-W Shu and S Osher, J Comp Phys, 77:439–471, 1988], as well as 'RK1' with the first order of accuracy in time).

In this version, Piastra2D uses the simplest possible 8-wave (or Powell (1994,1998)) approach for B-divergence cleaning in MHD equations (see [G. Toth, J Comp Phys, 161, 605 (2000)]). We plan to include more sophisticated methods for monopole constraint control in future. 

To use the code, you should have Python 3 with NumPy installed. You can adjust the parameters of the simulation by varying the variables "aux.rec_type", "aux.flux_type" and "aux.RK_order" in the main file "piastra2D_main_***.py".
By default, I set [aux.rec_type = 'PPM', aux.flux_type = 'HLLC', aux.RK_order = 'RK3'] for hydro and [aux.rec_type = 'PPM', aux.flux_type = 'HLL', aux.RK_order = 'RK3'] for MHD. Also, I set a unit square [0..1, 0..1] as a computational domain. In some test problems, I use different grids and I internally reshape it to fit the initial fluid state in "init_cond.py" file. The user can do the same or just change the domain in the main code.

To set the initial conditions for the simulation, you can choose between different examples/test in the file "init_cond_***.py" and add their names into the main file, or write them by yourself. Have fun!

To learn more about finite volume approach in fluid dynamics simulations, one can read a book by [E.F. Toro "Riemann Solvers and Numerical Methods for Fluid Dynamics: A practical introduction" (2009)].
To read about some modern solvers -- I recommend a review article by [D.S. Balsara "Higher-order accurate space-time schemes for computational astrophysics—Part I: finite volume methods", Living Rev Comput Astrophys 3:2 (2017)].
